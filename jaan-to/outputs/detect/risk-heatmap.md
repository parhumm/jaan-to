# Risk Heatmap ‚Äî claude-code

---
title: "Risk Heatmap ‚Äî claude-code"
id: "PACK-2026-001-HEATMAP"
version: "1.0.0"
status: draft
date: 2026-02-09
target:
  name: "claude-code"
  platform: "all"
  commit: "8bafe197b04b1b15eaac18e192d87daf219489db"
  branch: "refactor/skill-naming-cleanup"
tool:
  name: "detect-pack"
  version: "1.0.0"
  rules_version: "2024.1"
confidence_scheme: "four-level"
findings_summary:
  critical: 0
  high: 4
  medium: 15
  low: 21
  informational: 92
overall_score: 9.9
lifecycle_phase: post-build
---

> Generated by jaan.to detect-pack | 2026-02-09

## Overall Risk Heatmap

| Domain | Critical | High | Medium | Low | Info | Score | Status |
|--------|----------|------|--------|-----|------|-------|--------|
| **Dev** | 0 | **4** | 13 | 9 | 35 | 8.3 | ‚ö†Ô∏è Needs attention |
| **Design** | 0 | 0 | 1 | 6 | 17 | 9.2 | ‚úÖ Good |
| **Writing** | 0 | 0 | 1 | 5 | 19 | 8.6 | ‚úÖ Good |
| **Product** | 0 | 0 | 0 | 1 | 14 | 9.9 | ‚úÖ Excellent |
| **UX** | 0 | 0 | 0 | 0 | 7 | 10.0 | ‚úÖ N/A (CLI) |
| **TOTAL** | **0** | **4** | **15** | **21** | **92** | **9.9** | ‚úÖ Excellent |

### Risk Distribution

```
Total Findings: 132

Critical (0):
High (4):      ‚ñà‚ñà‚ñà‚ñà 3%
Medium (15):   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 11%
Low (21):      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 16%
Info (92):     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 70%
```

---

## Top Risks by Domain

### üî¥ Dev Domain ‚Äî 4 High Findings

#### H-1: No Test Framework (F-TEST-002)
**Severity**: High | **Confidence**: Confirmed (0.99)
**Evidence**: E-DEV-019

**Description**: No unit/integration testing framework detected. Shell scripts (1,407 lines across 14 files) lack test coverage.

**Impact**:
- Risk of regressions when modifying scripts
- No automated validation of plugin lifecycle
- Difficult to ensure skill reliability

**Recommendation**:
- Implement Jest or Bats (Bash Automated Testing System) for shell scripts
- Add test coverage for critical hooks (pre/post skill execution)
- Target 60%+ coverage for core plugin logic

**Related Findings**: F-TEST-004 (Unknown test coverage, Tentative confidence)

---

#### H-2: No SAST Scanning (F-SEC-002)
**Severity**: High | **Confidence**: Firm (0.90)
**Evidence**: E-DEV-037

**Description**: No static application security testing tools detected in CI/CD pipeline.

**Impact**:
- Security vulnerabilities may go undetected
- No automated code quality checks for security anti-patterns
- Risk of shell injection, path traversal, or other OWASP top 10 issues

**Recommendation**:
- Add ESLint with security plugins (@eslint-community/eslint-plugin-security)
- Consider Snyk Code or GitHub Advanced Security (free for open source)
- Run shellcheck on all shell scripts (already have EditorConfig for this)

**Related Findings**: F-SEC-005 (Shell scripts with elevated privileges, Tentative)

---

#### H-3: No Dependency Vulnerability Scanning (F-SEC-003)
**Severity**: High | **Confidence**: Firm (0.90)
**Evidence**: E-DEV-038

**Description**: No `npm audit` or Dependabot detected in CI pipeline. Large dependency tree (900+ packages, 627MB) not scanned for known vulnerabilities.

**Impact**:
- Vulnerable dependencies may be present undetected
- No alerts for critical CVEs in transitive dependencies
- Documentation site dependencies (Docusaurus ecosystem) not monitored

**Recommendation**:
- Add `npm audit --audit-level=high` to CI pipeline
- Enable GitHub Dependabot (free for public repos)
- Consider `npm audit fix` as pre-commit hook

**Related Findings**: F-SEC-006 (No SBOM generation, Tentative)

---

#### H-4: No Security Scanning in CI (F-CICD-005)
**Severity**: High | **Confidence**: Confirmed (1.00)
**Evidence**: E-DEV-030

**Description**: CI pipeline (GitHub Actions) builds documentation but lacks security checks (SAST, dependency scanning, secret scanning).

**Impact**:
- Security issues not caught before merge
- No automated gate for high-severity vulnerabilities
- Manual security review required for every PR

**Recommendation**:
- Integrate GitHub Secret Scanning (free for public repos)
- Add npm audit step in CI workflow
- Consider gitleaks for historical secret scanning

**Related Findings**: F-SEC-008 (No signed commits enforcement, Uncertain)

---

### üü° Design Domain ‚Äî 1 Medium Finding

#### M-1: Governance Gaps (F-GOV-001)
**Severity**: Medium | **Confidence**: Confirmed (0.99)
**Evidence**: E-DSN-018, E-DSN-020, E-DSN-021

**Description**: Design governance lacks component library tooling (Storybook), visual regression testing, and CODEOWNERS enforcement.

**Impact**:
- Risk of design drift without visual regression tests
- No component documentation/playground
- Design changes not automatically routed to designers for review

**Recommendation** (optional, not critical for CLI tool):
- Add Storybook if building more custom components
- Consider Percy or Chromatic for visual regression (if budget allows)
- Add CODEOWNERS for `website/docs/src/css/` and `website/docs/static/img/`

**Severity Justification**: Medium (not High) because this is a CLI tool with minimal UI surface area ‚Äî documentation site design is secondary concern.

---

### üü° Writing Domain ‚Äî 1 Medium Finding

#### M-2: Limited i18n Maturity (F-I18N-001)
**Severity**: Medium | **Confidence**: Confirmed (0.95)
**Evidence**: E-WRT-I18N-001, E-WRT-I18N-002

**Description**: Plugin interface and documentation remain English-only. i18n maturity score: 4.5/10.

**Impact**:
- Non-English speakers must use English interface
- Global adoption limited by language barrier
- Skills can generate multi-language outputs, but plugin itself is monolingual

**Note**: Plugin DOES support multi-language output generation (via `language` setting in config), so this is UI-layer limitation only.

**Recommendation**:
- Add i18n for skill descriptions and prompts using `language` setting
- Translate SKILL.md frontmatter (description, examples)
- Consider Docusaurus i18n for documentation site

**Severity Justification**: Medium because plugin serves developers (English proficiency common) and already supports multi-language output ‚Äî this is about interface localization, not output capability.

---

### üü¢ Product, UX Domains ‚Äî No High/Medium Risks

**Product Domain** (9.9/10): Only 1 Low finding (no feature flags, appropriate for scope)
**UX Domain** (10.0/10): N/A status (CLI tool, no UI)

---

## Risk Prioritization Matrix

### By Severity √ó Confidence

| Severity | Confirmed | Firm | Tentative | Uncertain |
|----------|-----------|------|-----------|-----------|
| Critical | - | - | - | - |
| High | 2 (H-1, H-4) | 2 (H-2, H-3) | - | - |
| Medium | 2 (M-1, M-2) | - | - | - |
| Low | 18 | 3 | - | - |
| Info | 90 | 2 | - | - |

**Total High-Confidence Findings**: 122 of 132 (92%)

---

## Cross-Domain Risk Patterns

### Pattern 1: Testing & Quality Assurance Gaps
**Affected Domains**: Dev (testing), Design (visual regression)
**Severity**: High (Dev), Medium (Design)

The repository lacks automated testing at multiple levels:
- No unit/integration tests for shell scripts
- No visual regression tests for documentation site
- No test coverage metrics

**Recommendation**: Prioritize testing infrastructure ‚Äî start with shell script tests (highest risk), then visual regression (lower priority).

---

### Pattern 2: Security Tooling Gaps
**Affected Domains**: Dev (security, cicd)
**Severity**: High (3 findings)

Security scanning is absent across SAST, dependency vulnerabilities, and CI enforcement:
- No static analysis tools
- No npm audit in pipeline
- No secret scanning

**Recommendation**: Quick win ‚Äî enable free tools (GitHub Dependabot, secret scanning, npm audit). These require minimal configuration and provide immediate value.

---

### Pattern 3: Governance & Process Maturity
**Affected Domains**: Dev (standards), Design (governance), Writing (i18n)
**Severity**: Medium (2 findings) + Low (multiple)

While technical quality is high, process maturity has gaps:
- No CODEOWNERS for design files
- No i18n for interface
- EditorConfig issues (mixed line endings, shell scripts)

**Recommendation**: Lower priority than security/testing. Address opportunistically as project scales.

---

## Risk Score Calculation

### Overall Score Formula
```
overall_score = 10 - (critical * 2.0 + high * 1.0 + medium * 0.4 + low * 0.1) / max(total_findings, 1)
             = 10 - (0 * 2.0 + 4 * 1.0 + 15 * 0.4 + 21 * 0.1) / 132
             = 10 - (0 + 4 + 6 + 2.1) / 132
             = 10 - 12.1 / 132
             = 10 - 0.092
             = 9.908
             ‚âà 9.9/10
```

### Domain Score Calculation
Domain scores are weighted averages of aspect scores within each domain:

- **Dev**: (8.8 + 9.9 + 8.5 + 7.1 + 7.8 + 9.8 + 7.2 + 8.4 + 7.5) / 9 = **8.3/10**
- **Design**: (9.8 + 8.9 + 10.0 + 10.0 + 8.8 + 7.7) / 6 = **9.2/10**
- **Product**: (10.0 + 10.0 + 10.0 + 10.0 + 10.0 + 9.5 + 10.0) / 7 = **9.9/10**
- **UX**: All aspects 10.0 (N/A status) = **10.0/10**
- **Writing**: (8.2 + 9.2 + 10.0 + 8.5 + 7.0 + 8.7) / 6 = **8.6/10**

---

## Actionable Recommendations

### Immediate (High Priority)
1. **Add npm audit to CI pipeline** ‚Äî 15 minutes, prevents vulnerable dependencies
2. **Enable GitHub Dependabot** ‚Äî 5 minutes, free for public repos
3. **Enable GitHub Secret Scanning** ‚Äî 5 minutes, free for public repos
4. **Run shellcheck on all scripts** ‚Äî Already have EditorConfig shellcheck enabled, enforce in CI

### Short-Term (Medium Priority)
5. **Implement test framework** ‚Äî Bats for shell scripts, Jest for JS utilities
6. **Add SAST scanning** ‚Äî ESLint security plugins or Snyk Code
7. **Resolve unknowns backlog** ‚Äî Investigate 10 Tentative/Uncertain findings

### Long-Term (Low Priority)
8. **Add i18n for plugin interface** ‚Äî Translate skill descriptions and prompts
9. **Design governance** ‚Äî CODEOWNERS, visual regression (if scaling design system)
10. **Documentation improvements** ‚Äî Architecture diagrams, API docs

---

## Summary

**Overall Assessment**: Repository is in **excellent health** (9.9/10) with well-defined product, strong design consistency, and professional writing standards.

**Primary Risk**: Dev domain security/testing gaps (4 High findings). All High findings are actionable with free tools and minimal setup time.

**Confidence**: 92% of findings are high-confidence (Confirmed/Firm), indicating strong evidence base. 10 findings require further investigation (see [Unknowns Backlog](unknowns-backlog.md)).
